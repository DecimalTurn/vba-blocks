{
  "name": "vbapm",
  "version": "0.6.14",
  "description": "A package manager and build tool for VBA",
  "repository": "https://github.com/vbapm/core.git",
  "contributors": [
    "Martin Leduc <31558169+DecimalTurn@users.noreply.github.com> (https://github.com/DecimalTurn)",
    "Tim Hall <tim.hall.engr@gmail.com> (https://github.com/timhall)"
  ],
  "license": "MIT",
  "bin": {
    "vbapm": "lib/vbapm.js",
    "vba": "lib/vbapm.js"
  },
  "main": "lib/index.js",
  "types": "lib/src/index.d.ts",
  "exports": {
    ".": {
      "require": "./lib/index.js",
      "types": "./lib/src/index.d.ts"
    }
  },
  "files": [
    "lib/",
    "addins/build/",
    "run-scripts/",
    "LICENSE",
    "README.md"
  ],
  "engines": {
    "node": ">=18.0.0"
  },
  "scripts": {
    "format": "prettier --write \"**/*.{ts,js}\"",
    "format:check": "prettier --check \"**/*.{ts,js}\"",
    "test": "jest --runInBand",
    "typecheck": "tsc",
    "deps": "npm i",
    "dev": "run-s deps typecheck format:check test build:cli",
    "test:e2e": "jest --config e2e.config.js --runInBand",
    "build": "rimraf lib && rollup -c",
    "build:lib": "run-s build && tsc -p tsconfig.build.json",
    "build:cli": "run-s build && node scripts/ensure-vendor",
    "build:dev": "cross-env NODE_ENV=development rollup -c",
    "build:addins": "cd addins && node --no-warnings ../scripts/build-addins",
    "build:bootstrap": "cd scripts/bootstrap && node --no-warnings ../../lib/vbapm build",
    "clean": "rimraf lib && rimraf dist && rimraf addins/build"
  },
  "jest": {
    "preset": "ts-jest",
    "testEnvironment": "node",
    "testPathIgnorePatterns": [
      "/node_modules/",
      "/lib/"
    ],
    "moduleNameMapper": {
      "^@timhall/dedent$": "<rootDir>/node_modules/@timhall/dedent/dist/dedent.js"
    },
    "snapshotFormat": {
      "escapeString": true,
      "printBasicPrototype": true
    }
  },
  "dependencies": {
    "@timhall/ansi-colors": "^5.0.0",
    "@timhall/dedent": "^0.9.1",
    "archiver": "^7.0.1",
    "conf": "^3",
    "date-fns": "^2",
    "debug": "^4",
    "decompress": "^4",
    "editorconfig": "^0.15.3",
    "env-paths": "^2",
    "fs-extra": "^7",
    "isomorphic-git": "^1.37.1",
    "logic-solver": "^2",
    "meant": "^1.0",
    "mri": "^1",
    "node-fetch": "^2",
    "open": "^6",
    "pretty-hrtime": "^1",
    "sanitize-filename": "^1",
    "semver": "^5",
    "tmp": "^0.2.5",
    "@decimalturn/toml-patch": "^0.7",
    "walk-sync": "^4.0.1",
    "xml-js": "^1.6"
  },
  "devDependencies": {
    "@rollup/plugin-commonjs": "^15.1.0",
    "@rollup/plugin-json": "^4.1.0",
    "@rollup/plugin-node-resolve": "^9.0.0",
    "@rollup/plugin-replace": "^2.3.3",
    "@rollup/plugin-typescript": "^6.0.0",
    "@types/archiver": "^2",
    "@types/fs-extra": "^5",
    "@types/jest": "^29",
    "@types/node": "^22",
    "@types/node-fetch": "^2.6.13",
    "@types/semver": "^5",
    "@types/tmp": "^0.0",
    "aws-sdk": "^2.562.0",
    "builtin-modules": "^3.0.0",
    "cross-env": "^5",
    "dotenv": "^7.0.0",
    "jest": "^29",
    "mustache": "^3",
    "npm-run-all": "^4",
    "prettier": "^3",
    "rimraf": "^6.1.3",
    "rollup": "^2.32.1",
    "rollup-plugin-terser": "^7.0.2",
    "ts-jest": "^29",
    "tslib": "^1.9.3",
    "typescript": "^5",
    "url-join": "^4.0.1"
  },
  "overrides": {
    "minimatch": "^10.2.1"
  },
  "json-comments": {
    "tips": "You may install the JsonComments plugin to enable commenting functionality for JSON files, see: https://github.com/zhangfisher/json_comments_extension",
    "package.json": {
      "scripts.format": "Formats all .ts and .js files using Prettier",
      "scripts.format:check": "Checks all .ts and .js files with Prettier",
      "scripts.test": "Runs Jest tests in a single thread",
      "scripts.typecheck": "Runs the TypeScript compiler to check for type errors",
      "scripts.test:e2e": "Runs end-to-end tests using a specific Jest configuration",
      "scripts.build:lib": "Core build: rollup bundle + .d.ts generation (used by both npm and standalone channels)",
      "scripts.build:cli": "Standalone CLI build: rollup bundle (no sourcemaps, no .d.ts) + fetch vendored Node binary",
      "scripts.build:dev": "Allows to quickly rebuild the project in development mode with environment variables set for easier debugging of the js/ts code",
      "scripts.build:addins": "Builds the add-ins by running a custom build script in the addins directory",
      "scripts.build:bootstrap": "Update the bootstrap file (used to build the addin) by using the latest addin build (inception!)",
      "scripts.clean": "Removes generated files from lib, dist, and addins/build directories",
      "devDependencies.cross-env": "Used to set environment variables in a cross-platform-compatible way for build scripts",
      "overrides": "Pins vulnerable transitive dependencies to patched versions to remove critical npm audit findings without large upstream upgrades.",
      "overrides.minimist": "Prototype pollution fix, mainly needed for ts-jest/handlebars transitive chain.",
      "overrides.underscore": "Arbitrary code execution mitigation, mainly needed for logic-solver transitive dependency.",
      "overrides.shell-quote": "Command injection advisory mitigation, mainly needed for npm-run-all transitive dependency."
    }
  }
}
